<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Russian Noun Declensions</title>  
    <link rel="shortcut icon" type="image/x-icon" href="favicon.ico" />
    <style>
      rt {font-size:14px;vertical-align:top;}
      td {border:1px solid black; margin: 0; padding: 0;}
      body { margin: 0; padding: 0; }
      .container { margin: 0 auto; width: 960px; }
    </style>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
    <script>
      class Problem {
        constructor(russian_sentence, english_translation, word, answer, explanation, animate, group, answer_declension) {
          this.russian_sentence = russian_sentence;
          this.english_translation = english_translation;
          this.word = word;
          this.answer = answer;
          this.explanation = explanation;
          this.animate = animate;
          this.group = group;
          this.answer_declension = answer_declension;
        }
      }

      var russian_problem;
      var problemSet;

      $(function(){
        //$("#headerFile").load("_header.html");
        var fileContents = readFile();
        convertToProblems(fileContents);
          
        resetProblem();
      });

      function collapseHeader() {
        var collapsibles = document.getElementsByClassName("collapsible");

        var content = collapsibles[0];
       if (content.style.display === "block") {
          content.style.display = "none";
        } else {
          content.style.display = "block";
        }
      }

      function readFile() {
        var reader = new XMLHttpRequest();
        reader.open("GET", "sentences.tsv", false);
        reader.send();
        if (reader.status==200) {
          result = reader.responseText;
        }
        return result
      }

      function convertToProblems(fileContents) {
        var objects = fileContents.split('\n');
        problemSet = new Array(objects.length - 1);
        for (var i=1; i<objects.length; i++) {
          var data = objects[i].split('\t');
          var problem = new Problem(data[0], data[1], data[2], data[3], data[4], data[5], data[6], data[7]);
          problemSet[i -1] = problem;
        }
      }

      function resetProblem() {
        var newProblemIndex = Math.floor(Math.random() * problemSet.length);
        russian_problem = problemSet[newProblemIndex];

        var inputStart = "<ruby><form action='javascript:;' onsubmit='checkWork()'><input autocomplete='off' type='text' id='entry'></input></form><rt>";
        var inputEnd = "</rt></ruby>"
        var input = inputStart + russian_problem.word + inputEnd;

        var sentence = russian_problem.russian_sentence.replace("___", input);
        var hintButton = "<button id='hintButton' onclick='giveHint()'>Hint</button>"

        var problemDiv = document.getElementById("problem");
        problemDiv.innerHTML = sentence+hintButton;

        var translationDiv = document.getElementById("translation");
        translationDiv.innerHTML = russian_problem.english_translation;

        var feedbackBox = document.getElementById("feedback");
        feedbackBox.style = "text-align:left;";
        feedbackBox.innerHTML = "";

        var hintbox = document.getElementById("hint");
        hintbox.style = "text-align:left;";
        hintbox.innerHTML = "";
      }

      function checkWork() {
        var feedbackBox = document.getElementById("feedback");
        var x = document.getElementById("entry").value.normalize("NFD").replace(/[\u0300-\u036f]/g, "").toLowerCase();
        if (x == russian_problem.answer.normalize("NFD").replace(/[\u0300-\u036f]/g, "").toLowerCase()) {
          feedbackBox.style = "background-color:#00DD0010;border-color:#00DD00;border-width:2px;border-style:solid;padding:15px;border-radius:15px"
          feedbackBox.innerHTML = "<p style='color:#00DD00;'><b>Correct!</b></p><p style='color:#00DD00;'>" + russian_problem.explanation + " -- " + russian_problem.answer +"!</p><button style='margin:auto;display:block;' id='newWordButton' onclick='resetProblem();'>New Word!</button>"
        } else {
          feedbackBox.style = "background-color:#FF000020;border-color:#FF0000;border-width:2px;border-style:solid;padding:15px;border-radius:15px"
          feedbackBox.innerHTML = "<p style='color:#FF0000;'><b>Incorrect!</b></p><p style='color:#FF0000;'>" + russian_problem.explanation + " -- " + russian_problem.answer +"!</p><button style='margin:auto;display:block;' id='newWordButton' onclick='resetProblem();'>New Word!</button>"
        }
      }

      function giveHint() {
        var hintbox = document.getElementById("hint");
        hintbox.style = "background-color:#DDDD0010;border-color:#DDDD00;border-width:2px;border-style:solid;padding:5px 15px;border-radius:5px"
        var hintText = "<p>Is this noun in the <a onclick='selectDeclensionGroup(1)' title='Ends with -а or -я'>first</a>, <a onclick='selectDeclensionGroup(2)' title='Ends with -й, a consonant, -е, -о, or masculine -ь'>second</a>, or <a onclick='selectDeclensionGroup(3)' title='Ends with -мя or feminine -ь'>third</a> declension group?</p>"
        
        hintbox.innerHTML = hintText
      }

      function selectDeclensionGroup(x) {
        var group1Table = `<table style='margin:auto' frame=void rules=rows>
          <tbody>
            <tr><td></td><td>Singular</td><td rowspan="7"></td><td>Plural</td></tr>
            <tr><td>Nominative</td><td>-a</td><td>-y</td></tr>
            <tr><td>Accusative</td><td>-u</td><td><a title='inanimate'>-y</a>/<a title='animate'>--</a></td></tr>
            <tr><td>Genitive</td><td>-y</td><td>--</td></tr>
            <tr><td>Prepositional</td><td>-ye</td><td>-ah</td></tr>
            <tr><td>Dative</td><td>-ye</td><td>-am</td></tr>
            <tr><td>Instrumental</td><td>-oy</td><td>-ami</td></tr>
          </tbody>
        </table>`
        var group2Table = `<table style='margin:auto' frame=void rules=rows>
          <tbody>
            <tr><td></td><td colspan="2">Singular</td><td rowspan="7"></td><td colspan="2">Plural</td></tr>
            <tr><td>Nominative</td><td>--</td><td>-o</td><td>-y</td><td>-a</td></tr>
            <tr><td>Accusative</td><td><a title='inanimate'>--</a>/<a title='animate'>-a</a></td><td>-o</td><td><a title='inanimate'>-y</a>/<a title='animate'>-ov/-yey</a></td><td><a title='inanimate'>-a</a>/<a title='animate'>--</a></td></tr>
            <tr><td>Genitive</td><td>-a</td><td>-a</td><td>-ov/-yey</td><td>--</td></tr>
            <tr><td>Prepositional</td><td>-ye</td><td>-ye</td><td>-ah</td><td>-ah</td></tr>
            <tr><td>Dative</td><td>-u</td><td>-u</td><td>-am</td><td>-am</td></tr>
            <tr><td>Instrumental</td><td>-om</td><td>-om</td><td>-ami</td><td>-ami</td></tr>
          </tbody>
        </table>`
        group3Table = `<table style='margin:auto' frame=void rules=rows>
          <tbody>
            <tr><td></td><td>Singular</td><td rowspan="7"></td><td>Plural</td></tr>
            <tr><td>Nominative</td><td>-ь</td><td>-и</td></tr>
            <tr><td>Accusative</td><td>-ь</td><td><a title='inanimate'>-и</a>/<a title='animate'>-ей</a></td></tr>
            <tr><td>Genitive</td><td>-и</td><td>-ей</td></tr>
            <tr><td>Prepositional</td><td>-и</td><td>-ях</td></tr>
            <tr><td>Dative</td><td>-и</td><td>-ям</td></tr>
            <tr><td>Instrumental</td><td>-ью</td><td>-ями</td></tr>
          </tbody>
        </table>`
        var hintbox = document.getElementById("hint");
        hintbox.style = "background-color:#DDDD0010;border-color:#DDDD00;border-width:2px;border-style:solid;padding:15px; border-radius:5px"
        if (x == 1) {
          hintbox.innerHTML = group1Table
        } else if (x == 2) {
          hintbox.innerHTML = group2Table
        } else {
          hintbox.innerHTML = group3Table
        }
      }

      function selectAnimacy(x, animacy) {
        var group1AnimateTable = `<table frame=void rules=rows>
          <tbody>
            <tr><td></td><td>Singular</td><td rowspan="7"></td><td>Plural</td></tr>
            <tr><td>Nominative</td><td>-a</td><td>-y</td></tr>
            <tr><td>Accusative</td><td>-u</td><td>--</td></tr>
            <tr><td>Genitive</td><td>-y</td><td>--</td></tr>
            <tr><td>Prepositional</td><td>-ye</td><td>-ah</td></tr>
            <tr><td>Dative</td><td>-ye</td><td>-am</td></tr>
            <tr><td>Instrumental</td><td>-oy</td><td>-ami</td></tr>
          </tbody>
        </table>`
         var group1InanimateTable = `<table frame=void rules=rows>
          <tbody>
            <tr><td></td><td>Singular</td><td rowspan="7"></td><td>Plural</td></tr>
            <tr><td>Nominative</td><td>-a</td><td>-y</td></tr>
            <tr><td>Accusative</td><td>-u</td><td>-y</td></tr>
            <tr><td>Genitive</td><td>-y</td><td>--</td></tr>
            <tr><td>Prepositional</td><td>-ye</td><td>-ah</td></tr>
            <tr><td>Dative</td><td>-ye</td><td>-am</td></tr>
            <tr><td>Instrumental</td><td>-oy</td><td>-ami</td></tr>
          </tbody>
        </table>`
        var group2AnimateTable = `<table frame=void rules=rows>
          <tbody>
            <tr><td></td><td colspan="2">Singular</td><td rowspan="7"></td><td colspan="2">Plural</td></tr>
            <tr><td>Nominative</td><td>--</td><td>-o</td><td>-y</td><td>-a</td></tr>
            <tr><td>Accusative</td><td>-a</td><td>-o</td><td>-ov</td><td>--</td></tr>
            <tr><td>Genitive</td><td>-a</td><td>-a</td><td>-ov</td><td>--</td></tr>
            <tr><td>Prepositional</td><td>-ye</td><td>-ye</td><td>-ah</td><td>-ah</td></tr>
            <tr><td>Dative</td><td>-u</td><td>-u</td><td>-am</td><td>-am</td></tr>
            <tr><td>Instrumental</td><td>-om</td><td>-om</td><td>-ami</td><td>-ami</td></tr>
          </tbody>
        </table>`
        var group2InanimateTable = `<table frame=void rules=rows>
          <tbody>
            <tr><td></td><td colspan="2">Singular</td><td rowspan="7"></td><td colspan="2">Plural</td></tr>
            <tr><td>Nominative</td><td>--</td><td>-o</td><td>-y</td><td>-a</td></tr>
            <tr><td>Accusative</td><td>--</td><td>-o</td><td>-y</td><td>-a</td></tr>
            <tr><td>Genitive</td><td>-a</td><td>-a</td><td>-ov</td><td>--</td></tr>
            <tr><td>Prepositional</td><td>-ye</td><td>-ye</td><td>-ah</td><td>-ah</td></tr>
            <tr><td>Dative</td><td>-u</td><td>-u</td><td>-am</td><td>-am</td></tr>
            <tr><td>Instrumental</td><td>-om</td><td>-om</td><td>-ami</td><td>-ami</td></tr>
          </tbody>
        </table>`
        group3AnimateTable = `<table frame=void rules=rows>
          <tbody>
            <tr><td></td><td>Singular</td><td rowspan="7"></td><td>Plural</td></tr>
            <tr><td>Nominative</td><td>-ь</td><td>-и</td></tr>
            <tr><td>Accusative</td><td>-ь</td><td>-ей</td></tr>
            <tr><td>Genitive</td><td>-и</td><td>-ей</td></tr>
            <tr><td>Prepositional</td><td>-и</td><td>-ях</td></tr>
            <tr><td>Dative</td><td>-ью</td><td>-ях</td></tr>
            <tr><td>Instrumental</td><td>-ью</td><td>-ях</td></tr>
          </tbody>
        </table>`
        group3InanimateTable = `<table frame=void rules=rows>
          <tbody>
            <tr><td></td><td>Singular</td><td rowspan="7"></td><td>Plural</td></tr>
            <tr><td>Nominative</td><td>-ь</td><td>-и</td></tr>
            <tr><td>Accusative</td><td>-ь</td><td>-и</td></tr>
            <tr><td>Genitive</td><td>-и</td><td>-ей</td></tr>
            <tr><td>Prepositional</td><td>-и</td><td>-ях</td></tr>
            <tr><td>Dative</td><td>-ью</td><td>-ях</td></tr>
            <tr><td>Instrumental</td><td>-ью</td><td>-ях</td></tr>
          </tbody>
        </table>`
        var hintbox = document.getElementById("hint");
        if (x == 1 && animacy) {
          hintbox.innerHTML = group1AnimateTable
        } else if (x == 1 && !animacy) {
          hintbox.innerHTML = group1InanimateTable
        } else if (x == 2 && animacy) {
          hintbox.innerHTML = group2AnimateTable
        } else if (x == 2 && !animacy) {
          hintbox.innerHTML = group2InanimateTable
        } else if (x == 3 && animacy) {
          hintbox.innerHTML = group3AnimateTable
        }else {
          hintbox.innerHTML = group3InanimateTable
        }
      }
    </script>
  </head>
  <body class='no-header-page wsite-theme-light wsite-page-index'>
    <div id="top-background" style="height:44px;background-color:black;" onclick="collapseHeader()";>
      <img src="settings.png" style="float:right; height:30px; width:30px; margin:7px 10% 7px 5px;"/>
    </div>
    <div id="main-wrap" style="background-color: white;">
      <div class="collapsible" style="border: 1px black; border-style: none solid solid solid; border-radius: 0px 0px 10px 10px; height: 150px; width: 70%;background-color: white; margin: auto; position: relative; z-index: 1; display: none; padding: 10px 5%;">
        <span style="width: 50%; display: inline-block;">
          <input type="checkbox" id="nom" name="nom" value="Nominative" checked />
          <label for="nom"> Nominative / именительный</label><br/>

          <input type="checkbox" id="acc" name="acc" value="Accusative" checked />
          <label for="acc"> Accusative / винительный</label><br/>

          <input type="checkbox" id="gen" name="gen" value="Genitive" checked />
          <label for="gen"> Genitive / родительный</label><br/>

          <input type="checkbox" id="dat" name="dat" value="Dative" checked />
          <label for="dat"> Dative / дательный</label><br/>

          <input type="checkbox" id="prep" name="prep" value="Prepositional" checked />
          <label for="prep"> Prepositional / предложный</label><br/>

          <input type="checkbox" id="inst" name="inst" value="Instrumental" checked />
          <label for="inst"> Instrumental / творительный</label><br/>
        </span>
        <span style="width: 40%; display: inline-block;">
          <input type="checkbox" id="sing" name="sing" value="Singular" checked />
          <label for="sing"> Singular / единственный</label><br/>

          <input type="checkbox" id="plur" name="plur" value="Plural" checked />
          <label for="plur"> Plural / множественный</label><br/>

          <br/>

          <input type="checkbox" id="g1" name="g1" value="Group 1" checked />
          <label for="g1"> Group 1 / I склонение</label><br/>

          <input type="checkbox" id="g2" name="g2" value="Group 2" checked />
          <label for="g2"> Group 2 / II склонение</label><br/>

          <input type="checkbox" id="g3" name="g3" value="Group 3" checked />
          <label for="g3"> Group 3 / III склонение</label><br/>
        </span>
      </div>
      <div class="container" style="height: 500px; background-color: white; position: absolute; top: 60px; left: 0px; right: 0px; margin-inline: auto;">
        <div id="problem" class="paragraph" style="text-align:left;"></div>
        <br />
        <div id="translation" class="paragraph" style="text-align:left;"></div>
        <br />
        <br />
        <br />
        <div style="clear:both"></div>
        <div id="hint" class="paragraph" style="text-align:left;"></div>
        <br />
        <div id="feedback" class="paragraph" style="text-align:left;"></div>
      </div>
    </div>
  </body>
</html>